<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(~{::title}, ~{::main})}">
<head>
  <title>[[#{alerts.title}]]</title>
</head>

<main>
  <div class="row between">
    <h1>[[#{alerts.title}]]</h1>
    <a class="btn" th:href="@{/alerts/new}">[[#{alerts.new}]]</a>
  </div>

  <section class="card">
    <table>
      <thead>
      <tr>
        <th>ID</th>
        <th>[[#{alerts.type}]]</th>
        <th>[[#{alerts.severity}]]</th>
        <th>[[#{alerts.employee}]]</th>
        <th>[[#{alerts.status}]]</th>
        <th>[[#{alerts.createdAt}]]</th>
        <th>Ações</th>
      </tr>
      </thead>
      <tbody>
      <tr th:if="${page.totalElements == 0}">
        <td colspan="7" class="empty">[[#{alerts.empty}]]</td>
      </tr>

      <tr th:each="a : ${page.content}" th:unless="${page.totalElements == 0}">
        <td th:text="${a.id}"></td>
        <td th:text="${a.type}"></td>
        <td th:text="${a.severity}"></td>
        <td th:text="${a.employee.name}"></td>
        <td th:text="${a.status}"></td>
        <td th:text="${#temporals.format(a.createdAt,'dd/MM/yyyy HH:mm')}"></td>
        <td class="actions">
          <a th:href="@{'/alerts/' + ${a.id} + '/edit'}">[[#{alerts.edit}]]</a>

          <form th:action="@{'/alerts/' + ${a.id} + '/delete'}"
                method="post" style="display:inline;"
                onsubmit="return confirm('Tem certeza que deseja excluir este alerta?');">
            <button class="linkbtn danger" type="submit">
              [[#{alerts.delete}]]
            </button>
          </form>

          <form th:if="${a.status.name() != 'RESOLVED'}"
                th:action="@{'/alerts/' + ${a.id} + '/resolve'}"
                method="post" style="display:inline;">
            <button class="linkbtn" type="submit">
              [[#{alerts.resolve}]]
            </button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>

    <div class="pagination">
      <a th:if="${page.hasPrevious()}"
         th:href="@{/alerts(page=${page.number-1},size=${page.size})}">← Prev</a>
      <span th:text="${page.number + 1} + ' / ' + ${page.totalPages}"></span>
      <a th:if="${page.hasNext()}"
         th:href="@{/alerts(page=${page.number+1},size=${page.size})}">Next →</a>
    </div>
  </section>
</main>
</html>
